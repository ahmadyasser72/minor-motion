---
import DaftarTugas from "$lib/layouts/daftar-tugas.astro";
import type { Tugas } from "$lib/types";

import { getEntry } from "astro:content";
import { getCollection } from "astro:content";

const { mata_kuliah } = Astro.params;
if (mata_kuliah === undefined) throw new Error("link tidak valid");

const entry = await getEntry("mata-kuliah", mata_kuliah);
if (entry === undefined) throw new Error("mata kuliah tidak ditemukan");

const allTugas: Tugas[] = (
  await getCollection(
    "tugas",
    ({ data }) => data["mata-kuliah"].id === mata_kuliah
  )
).map(({ slug, data }) => ({ ...data, id: slug }));
---

<DaftarTugas
  {allTugas}
  heading1={entry.id}
  heading2={entry.data.nama}
  title=`Daftar Tugas ${mata_kuliah.toUpperCase()}`
  breadcrumbs={[{ label: mata_kuliah }]}
  displaySubject={false}
/>
